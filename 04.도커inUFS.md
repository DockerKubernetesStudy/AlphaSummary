# 유니온 파일 시스템 (UFS)

- 도커가 **어떻게 이미지를 Layer 단위로 관리할까**
- UFS
  - **여러 개의 파일 시스템을 하나의 파일 시스템에 마운트하는 기능**
  - 여러 파일 시스템을 하나로 합치다보면, 중복되는 파일이 분명히 있다.
  - UFS는 이 경우 나중에 마운트된 파일로 덮어 써버린다. (-> 디스크에 효율을 줌)
- UFS in Docker
  - 하나의 이미지에서 생성된 컨테이너들이 동일한 파일 시스템을 **공유하고 있다면** 어떻게 컨테이너가 **독립적으로** 실행될 수 있는가?
  - 즉, "공유"와 "독립"은 양립하기에 어색한 표현은 아닌가?
  - => UFS의 COW(Copy on Write) 전략
    - 하위 레이어(base layer) 위에 새로운 layer가 쌓일 경우, 하위 layer는 `READ ONLY` 상태가 된다.
    - 상위 layer에서 하위 layer를 **복사하여 사용(CoW)하기 때문에**, 상위 layer는 하위 layer에 아무런 영향을 주지 않는다.
- 도커에서 관리되는 모든 레이어와 관련된 정보는 호스트의 파일시스템 내의 `/var/lib/docker` 폴더에 저장된다.
- 이 영역을 `Docker Area` 혹은 `Backing Filesystem`이라고 부른다.